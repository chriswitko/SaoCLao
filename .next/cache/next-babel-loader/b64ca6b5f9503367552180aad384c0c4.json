{"ast":null,"code":"import _Object$defineProperty from \"@babel/runtime-corejs2/core-js/object/define-property\";\nimport _Object$defineProperties from \"@babel/runtime-corejs2/core-js/object/define-properties\";\nimport _Object$getOwnPropertyDescriptors from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptors\";\nimport _Object$getOwnPropertyDescriptor from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptor\";\nimport _Object$getOwnPropertySymbols from \"@babel/runtime-corejs2/core-js/object/get-own-property-symbols\";\nimport _slicedToArray from \"@babel/runtime-corejs2/helpers/esm/slicedToArray\";\nimport _toConsumableArray from \"@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = _Object$keys(object); if (_Object$getOwnPropertySymbols) { var symbols = _Object$getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return _Object$getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (_Object$getOwnPropertyDescriptors) { _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useReducer, useCallback, useMemo, useEffect } from 'react';\nimport constate from 'constate';\nimport { useImmerReducer } from 'use-immer';\nimport pull from 'lodash/pull';\nimport remove from 'lodash/remove';\nimport { trackActionTypes } from '../constants/actionTypes.constant';\nimport { myApiEndPoint, myApiAxiosInstance } from '../constants/myApi.constant';\nimport { convertArrayToObject, findObjectsByKeys } from '../helpers/utils.helper';\nvar initialState = {\n  tracks: {},\n  trendingTracks: [],\n  favoriteTracks: [],\n  favoriteTrackIds: []\n};\n\nvar reducer = function reducer() {\n  var _state$trendingTracks;\n\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n\n  var _ref = arguments.length > 1 ? arguments[1] : undefined,\n      type = _ref.type,\n      payload = _ref.payload;\n\n  switch (type) {\n    case trackActionTypes.TRENDING_TRACKS_FETCHED_SUCCESS:\n      var newTracks = convertArrayToObject(payload, 'id');\n\n      var newTrackIds = _Object$keys(newTracks).map(Number);\n\n      return void (state.tracks = _objectSpread({}, newTracks, {}, state.tracks), (_state$trendingTracks = state.trendingTracks).push.apply(_state$trendingTracks, _toConsumableArray(newTrackIds)));\n\n    case trackActionTypes.FAVORITE_TRACKS_FETCHED_SUCCESS:\n      return void (state.favoriteTracks = payload);\n\n    case trackActionTypes.FAVORITE_TRACKS_IDS_FETCHED_SUCCESS:\n      return void (state.favoriteTrackIds = payload);\n\n    case trackActionTypes.ADD_FAVORITE_TRACK:\n      return void (state.favoriteTrackIds.push(payload.id), state.tracks[payload.id].count_like += 1);\n\n    case trackActionTypes.REMOVE_FAVORITE_TRACK:\n      return void (pull(state.favoriteTrackIds, payload.id), state.tracks[payload.id].count_like -= 1);\n\n    default:\n      return state;\n  }\n};\n\nvar useTrack = function useTrack() {\n  var _useImmerReducer = useImmerReducer(reducer, initialState),\n      _useImmerReducer2 = _slicedToArray(_useImmerReducer, 2),\n      state = _useImmerReducer2[0],\n      dispatch = _useImmerReducer2[1];\n\n  var addTrendingTracks = useCallback(function (data) {\n    // useCallbackOnce here helps prevent previous tracks re-rendering\n    dispatch({\n      type: trackActionTypes.TRENDING_TRACKS_FETCHED_SUCCESS,\n      payload: data\n    });\n  }, []);\n  var addFavoriteTrackIds = useCallback(function (data) {\n    dispatch({\n      type: trackActionTypes.FAVORITE_TRACKS_IDS_FETCHED_SUCCESS,\n      payload: data\n    });\n  }, []);\n  var checkIsFavoriteTrack = useCallback(function (trackId) {\n    var isFavoriteTrack = state.favoriteTrackIds.includes(trackId);\n    return isFavoriteTrack;\n  }, [state.favoriteTrackIds]);\n  var addFavoriteTrack = useCallback(function (trackObj) {\n    dispatch({\n      type: trackActionTypes.ADD_FAVORITE_TRACK,\n      // desc order insertion\n      payload: trackObj\n    });\n  }, []);\n  var removeFavoriteTrack = useCallback(function (trackObj) {\n    dispatch({\n      type: trackActionTypes.REMOVE_FAVORITE_TRACK,\n      payload: trackObj\n    });\n  }, []);\n  return {\n    tracks: state.tracks,\n    favoriteTrackIds: state.favoriteTrackIds,\n    trendingTracks: findObjectsByKeys(state.trendingTracks, state.tracks),\n    addFavoriteTrackIds: addFavoriteTrackIds,\n    checkIsFavoriteTrack: checkIsFavoriteTrack,\n    addFavoriteTrack: addFavoriteTrack,\n    addTrendingTracks: addTrendingTracks,\n    removeFavoriteTrack: removeFavoriteTrack\n  };\n};\n\nvar _constate = constate(useTrack, function (value) {\n  return value.tracks;\n}, function (value) {\n  return value.trendingTracks;\n}, function (value) {\n  return value.addFavoriteTrackIds;\n}, function (value) {\n  return value.checkIsFavoriteTrack;\n}, function (value) {\n  return value.addFavoriteTrack;\n}, function (value) {\n  return value.addTrendingTracks;\n}, function (value) {\n  return value.removeFavoriteTrack;\n}),\n    _constate2 = _slicedToArray(_constate, 8),\n    TrackProvider = _constate2[0],\n    useTracks = _constate2[1],\n    useTrendingTracks = _constate2[2],\n    useAddFavoriteTrackIds = _constate2[3],\n    useIsFavoriteTrack = _constate2[4],\n    useAddFavoriteTrack = _constate2[5],\n    useAddTrendingTracks = _constate2[6],\n    useRemoveFavoriteTrack = _constate2[7];\n\nexport { TrackProvider, useTracks, useTrendingTracks, useAddFavoriteTrackIds, useIsFavoriteTrack, useAddFavoriteTrack, useAddTrendingTracks, useRemoveFavoriteTrack };","map":{"version":3,"sources":["C:/Users/PC/WebstormProjects/nextjs/SoundCloudClone/src/contexts/TrackContext.js"],"names":["useReducer","useCallback","useMemo","useEffect","constate","useImmerReducer","pull","remove","trackActionTypes","myApiEndPoint","myApiAxiosInstance","convertArrayToObject","findObjectsByKeys","initialState","tracks","trendingTracks","favoriteTracks","favoriteTrackIds","reducer","state","type","payload","TRENDING_TRACKS_FETCHED_SUCCESS","newTracks","newTrackIds","map","Number","push","FAVORITE_TRACKS_FETCHED_SUCCESS","FAVORITE_TRACKS_IDS_FETCHED_SUCCESS","ADD_FAVORITE_TRACK","id","count_like","REMOVE_FAVORITE_TRACK","useTrack","dispatch","addTrendingTracks","data","addFavoriteTrackIds","checkIsFavoriteTrack","trackId","isFavoriteTrack","includes","addFavoriteTrack","trackObj","removeFavoriteTrack","value","TrackProvider","useTracks","useTrendingTracks","useAddFavoriteTrackIds","useIsFavoriteTrack","useAddFavoriteTrack","useAddTrendingTracks","useRemoveFavoriteTrack"],"mappings":"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","sourcesContent":["import {\n  useReducer, useCallback, useMemo, useEffect,\n} from 'react';\nimport constate from 'constate';\nimport { useImmerReducer } from 'use-immer';\nimport pull from 'lodash/pull';\nimport remove from 'lodash/remove';\nimport { trackActionTypes } from '../constants/actionTypes.constant';\nimport { myApiEndPoint, myApiAxiosInstance } from '../constants/myApi.constant';\nimport {\n  convertArrayToObject,\n  findObjectsByKeys,\n} from '../helpers/utils.helper';\n\nconst initialState = {\n  tracks: {},\n  trendingTracks: [],\n  favoriteTracks: [],\n  favoriteTrackIds: [],\n};\n\nconst reducer = (state = initialState, { type, payload }) => {\n  switch (type) {\n    case trackActionTypes.TRENDING_TRACKS_FETCHED_SUCCESS:\n      const newTracks = convertArrayToObject(payload, 'id');\n      const newTrackIds = Object.keys(newTracks).map(Number);\n\n      return void ((state.tracks = { ...newTracks, ...state.tracks }),\n      state.trendingTracks.push(...newTrackIds));\n\n    case trackActionTypes.FAVORITE_TRACKS_FETCHED_SUCCESS:\n      return void (state.favoriteTracks = payload);\n\n    case trackActionTypes.FAVORITE_TRACKS_IDS_FETCHED_SUCCESS:\n      return void (state.favoriteTrackIds = payload);\n\n    case trackActionTypes.ADD_FAVORITE_TRACK:\n      return void (state.favoriteTrackIds.push(payload.id),\n      (state.tracks[payload.id].count_like += 1));\n\n    case trackActionTypes.REMOVE_FAVORITE_TRACK:\n      return void (pull(state.favoriteTrackIds, payload.id),\n      (state.tracks[payload.id].count_like -= 1));\n\n    default:\n      return state;\n  }\n};\n\nconst useTrack = () => {\n  const [state, dispatch] = useImmerReducer(reducer, initialState);\n\n  const addTrendingTracks = useCallback((data) => { // useCallbackOnce here helps prevent previous tracks re-rendering\n    dispatch({\n      type: trackActionTypes.TRENDING_TRACKS_FETCHED_SUCCESS,\n      payload: data,\n    });\n  }, []);\n\n  const addFavoriteTrackIds = useCallback((data) => {\n    dispatch({\n      type: trackActionTypes.FAVORITE_TRACKS_IDS_FETCHED_SUCCESS,\n      payload: data,\n    });\n  }, []);\n\n  const checkIsFavoriteTrack = useCallback((trackId) => {\n    const isFavoriteTrack = state.favoriteTrackIds.includes(trackId);\n    return isFavoriteTrack;\n  }, [state.favoriteTrackIds]);\n\n  const addFavoriteTrack = useCallback((trackObj) => {\n    dispatch({\n      type: trackActionTypes.ADD_FAVORITE_TRACK, // desc order insertion\n      payload: trackObj,\n    });\n  }, []);\n\n  const removeFavoriteTrack = useCallback((trackObj) => {\n    dispatch({\n      type: trackActionTypes.REMOVE_FAVORITE_TRACK,\n      payload: trackObj,\n    });\n  }, []);\n\n  return {\n    tracks: state.tracks,\n    favoriteTrackIds: state.favoriteTrackIds,\n    trendingTracks: findObjectsByKeys(\n      state.trendingTracks,\n      state.tracks,\n    ),\n    addFavoriteTrackIds,\n    checkIsFavoriteTrack,\n    addFavoriteTrack,\n    addTrendingTracks,\n    removeFavoriteTrack,\n  };\n};\nexport const [\n  TrackProvider,\n  useTracks,\n  useTrendingTracks,\n  useAddFavoriteTrackIds,\n  useIsFavoriteTrack,\n  useAddFavoriteTrack,\n  useAddTrendingTracks,\n  useRemoveFavoriteTrack,\n] = constate(\n  useTrack,\n  (value) => value.tracks,\n  (value) => value.trendingTracks,\n  (value) => value.addFavoriteTrackIds,\n  (value) => value.checkIsFavoriteTrack,\n  (value) => value.addFavoriteTrack,\n  (value) => value.addTrendingTracks,\n  (value) => value.removeFavoriteTrack,\n);\n"]},"metadata":{},"sourceType":"module"}